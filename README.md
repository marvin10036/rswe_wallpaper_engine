# rswe_wallpaper_engine
Really Stupid Wallpaper Engine for the Xfce DE that works with GIFs, MP4 and static images. 


## Table of Contents
- [Dependencies](#dependencies)
- [Usage](#usage)
    - [Get the Workspace Last Image Path](#get-the-workspace-last-image-path)
    - [Running the script](#running-the-script)
        - [Flags](#flags)
- [Script Behaviour](#script-behaviour)
- [General Info](#general-info)
- [License](#license)
- [Disclaimer](#disclaimer)

## Dependencies

- GNU/linux environemnt with the Xfce DE.
- `ffmpeg`
- `imagemagick`
- `python3`

## Usage

### Get the Workspace Last Image Path

You can do it by running something like:

```
xfconf-query -c xfce4-desktop -l | grep last-image
```

This is gonna return all the paths to all your workspaces. Grab the one that you're gonna use. Notice that the path doesn't have trailing forward slashes (/). You should keep it that way, as putting a forward slash on the end causes abnormal behaviour on the program. This will be placed as the argument for the `-m` flag.

### Running the script

```
./RSWE.sh -w <wallpaper_folder> -v <video_frames_folder> -t <time_in_seconds> -m <workspace_last_image_path> [-h for help]
```

#### Flags

* `-w`: The full path of the folder where your wallpaper files are located. All the `.jpg`, `.png`, `.gif` and `.mp4` files should be on this folder.
* `-v`: The full path of the folder where you want the frames generated by the script (when opening `.gif` or  `.mp4` files) to be stored. The frames are not deleted for reusage.
* `-t`: The time in seconds that you'd want before changing the wallpapers.
* `-m`: The workspace last-image path. Which is the thing being altered by a command like `xfconf-query -c xfce4-desktop -p $MONITOR_WORKSPACE_PATH -s $Current_filepath` when changing the wallpaper.
* `-h`:  Display help text.

## Script Behaviour

Essentially this script is:

1. Searching for `.jpg`, `.png`, `.gif` or `.mp4` files on your wallpaper folder, and grabbing one file randomly.
2. If the file is either a `.jpg` or a `.png`, it just changes the wallpaper to that and sleeps for the duration of your `-t` flag. Then it will just search for the next wallpaper.
3. If it's any of the video type wallpapers (`.gif` or `.mp4`), it will see if it has already created a frame folder for it. 
    - If it has, it will plainly iterate through the frames in order, while using a sleep time saved on a `Metadata` file for each frame (only one constant framerate for `.mp4`, and a per frame delay for `.gif`), thus simulating an animation effect.
    - If it hasn't the folder. It will create it, and break the `.gif` or `.mp4` format into `.png` frames using `ffmpeg`. It will also create the `Metadata` file. **It will not play the animation immediately, but rather wait untill it is chosen again and have the frames folder present**.

The process playing the `.gif` or `.mp4` frames on loop on step 3, is a subprocess from the original script. And it's gonna be killed by the latter once the time defined by the `-t` flag is done (as the main process will be sleeping on that).

## General Info

- The wallpaper choice is always random.
- Only works for one workspace (but I guess you can run one of these for each workspace if you want).
- Memory usage was always less than 30MB on my testing. Running for a single workspace. But I think it depends on the file size.

## License

This project is licensed under the GPL v3 License. See the [LICENSE](LICENSE) file for details.

## Disclaimer

In addition to the warranty disclaimers in the GPL license, the software is provided "as is" and without any further warranties or guarantees. The author shall not be held liable for any damages resulting from the use of this software.
